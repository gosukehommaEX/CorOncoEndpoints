<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Association Parameter for Copulas Between Response and Time-to-Event Endpoints — CopulaParamResponseTTE • CorOncoEndpoints</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Association Parameter for Copulas Between Response and Time-to-Event Endpoints — CopulaParamResponseTTE"><meta name="description" content="Computes the copula association parameter (theta) that corresponds to a
specified correlation coefficient between a binary response endpoint and a
time-to-event (TTE) endpoint. This function solves for theta using the
relationship between the correlation coefficient and the copula function
via numerical integration and the secant method."><meta property="og:description" content="Computes the copula association parameter (theta) that corresponds to a
specified correlation coefficient between a binary response endpoint and a
time-to-event (TTE) endpoint. This function solves for theta using the
relationship between the correlation coefficient and the copula function
via numerical integration and the secant method."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CorOncoEndpoints</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to CorOncoEndpoints</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-usage.html">Advanced Usage and Examples</a></li>
    <li><a class="dropdown-item" href="../articles/theoretical-background.html">Theoretical Background</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/CorOncoEndpoints"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute Association Parameter for Copulas Between Response and Time-to-Event Endpoints</h1>
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/CorOncoEndpoints/blob/HEAD/R/CopulaParamResponseTTE.R" class="external-link"><code>R/CopulaParamResponseTTE.R</code></a></small>
      <div class="d-none name"><code>CopulaParamResponseTTE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the copula association parameter (theta) that corresponds to a
specified correlation coefficient between a binary response endpoint and a
time-to-event (TTE) endpoint. This function solves for theta using the
relationship between the correlation coefficient and the copula function
via numerical integration and the secant method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CopulaParamResponseTTE</span><span class="op">(</span><span class="va">p</span>, <span class="va">rho</span>, copula <span class="op">=</span> <span class="st">"Clayton"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Numeric. The true probability of the binary response endpoint.
Must be between 0 and 1 (exclusive).</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>Numeric. The desired correlation coefficient between the response
and TTE endpoints. Must be within the feasible range determined by
Fréchet-Hoeffding bounds for the given p.</p></dd>


<dt id="arg-copula">copula<a class="anchor" aria-label="anchor" href="#arg-copula"></a></dt>
<dd><p>Character. The copula family to use. Options are "Clayton"
or "Frank" (default is "Clayton").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric value representing the association parameter theta that
achieves the specified correlation rho.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates the copula association parameter theta by solving
the equation that relates the correlation coefficient to the copula function:
$$\rho = \sqrt{\frac{1-p}{p}} \left[1 + \frac{1}{1-p} \int_0^1 \log(1-u) \cdot c_y(u, 1-p; \theta) \, du\right]$$</p>
<p>where \(c_y(u, v; \theta) = \frac{\partial C(u, v; \theta)}{\partial u}\)
is the first partial derivative of the copula function C with respect to
its first argument.</p>
<p><strong>Clayton copula</strong>:
$$C(u_1, u_2; \theta) = (u_1^{-\theta} + u_2^{-\theta} - 1)^{-1/\theta}$$</p><ul><li><p>Parameter range: θ ∈ (0, ∞)</p></li>
<li><p>Cannot model negative dependence</p></li>
<li><p>Exhibits strong lower tail dependence</p></li>
<li><p>As θ → 0: independence; as θ → ∞: Fréchet upper bound</p></li>
</ul><p><strong>Frank copula</strong>:
$$C(u_1, u_2; \theta) = -\frac{1}{\theta} \log\left[1 + \frac{(e^{-\theta u_1} - 1)(e^{-\theta u_2} - 1)}{e^{-\theta} - 1}\right]$$</p><ul><li><p>Parameter range: θ ∈ (-∞, ∞)</p></li>
<li><p>Can model both positive and negative dependence</p></li>
<li><p>Exhibits symmetric tail dependence</p></li>
<li><p>As θ → -∞: Fréchet lower bound; θ = 0: independence; θ → ∞: Fréchet upper bound</p></li>
</ul><p>The function first checks whether the specified rho is within the feasible
range using <code><a href="CorBoundResponseTTE.html">CorBoundResponseTTE</a></code>. It then uses the secant
method to iteratively solve for theta. The secant method uses linear
interpolation between two points to find where the objective function
crosses zero.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The correlation between a binary response endpoint and an exponentially
distributed TTE endpoint depends only on the response probability p and
the copula parameter theta, not on the hazard rate of the TTE endpoint.
This is because the hazard rate only affects the scale of the TTE variable,
while the correlation structure is determined by the copula and the response
probability.</p>
<p>The secant method algorithm:</p><ol><li><p>Start with two initial values theta_0 and theta_1 (adaptively chosen based on rho)</p></li>
<li><p>Evaluate the objective function at both points: f_0 = f(theta_0), f_1 = f(theta_1)</p></li>
<li><p>Find the next approximation using linear interpolation:
theta_new = theta_1 - f_1 * (theta_1 - theta_0) / (f_1 - f_0)</p></li>
<li><p>Check for convergence (either |f_new| or |theta_new - theta_1| is small)</p></li>
<li><p>If not converged, update: theta_0 &lt;- theta_1, theta_1 &lt;- theta_new, and repeat</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Trivedi, P. K., &amp; Zimmer, D. M. (2005). Copula modeling: an introduction
for practitioners. Foundations and Trends in Econometrics, 1(1), 1-111.</p>
<p>Hofert, M., Kojadinovic, I., Maechler, M., &amp; Yan, J. (2018). Elements of
copula modeling with R. Springer.</p>
<p>Burden, R. L., &amp; Faires, J. D. (2010). Numerical Analysis (9th ed.).
Brooks/Cole.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="CorBoundResponseTTE.html">CorBoundResponseTTE</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Clayton copula with positive correlation</span></span></span>
<span class="r-in"><span><span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, copula <span class="op">=</span> <span class="st">"Clayton"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.069004</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Frank copula with positive correlation</span></span></span>
<span class="r-in"><span><span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, copula <span class="op">=</span> <span class="st">"Frank"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.598995</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Frank copula with negative correlation</span></span></span>
<span class="r-in"><span><span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, copula <span class="op">=</span> <span class="st">"Frank"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.732853</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare theta values across different copulas for the same correlation</span></span></span>
<span class="r-in"><span><span class="va">rho_target</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="va">theta_clayton</span> <span class="op">&lt;-</span> <span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="va">rho_target</span>, </span></span>
<span class="r-in"><span>                                         copula <span class="op">=</span> <span class="st">"Clayton"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta_frank</span> <span class="op">&lt;-</span> <span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="va">rho_target</span>, </span></span>
<span class="r-in"><span>                                       copula <span class="op">=</span> <span class="st">"Frank"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Clayton theta:"</span>, <span class="va">theta_clayton</span>, <span class="st">"\nFrank theta:"</span>, <span class="va">theta_frank</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clayton theta: 1.069004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frank theta: 2.598995 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explore relationship between correlation and theta for different p values</span></span></span>
<span class="r-in"><span><span class="va">rho_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta_p40</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">rho_seq</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.4</span>, rho <span class="op">=</span> <span class="va">r</span>, copula <span class="op">=</span> <span class="st">"Clayton"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta_p60</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">rho_seq</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">CopulaParamResponseTTE</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.6</span>, rho <span class="op">=</span> <span class="va">r</span>, copula <span class="op">=</span> <span class="st">"Clayton"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho_seq</span>, <span class="va">theta_p40</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"Correlation"</span>, ylab <span class="op">=</span> <span class="st">"Theta"</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"Clayton Copula: Correlation vs Theta"</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta_p40</span>, <span class="va">theta_p60</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">rho_seq</span>, <span class="va">theta_p60</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p = 0.4"</span>, <span class="st">"p = 0.6"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CopulaParamResponseTTE-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gosuke Homma</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

    </footer></div>





  </body></html>

