<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Theoretical Background • CorOncoEndpoints</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Theoretical Background">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CorOncoEndpoints</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to CorOncoEndpoints</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-usage.html">Advanced Usage and Examples</a></li>
    <li><a class="dropdown-item" href="../articles/theoretical-background.html">Theoretical Background</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/CorOncoEndpoints"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Theoretical Background</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/CorOncoEndpoints/blob/main/vignettes/theoretical-background.Rmd" class="external-link"><code>vignettes/theoretical-background.Rmd</code></a></small>
      <div class="d-none name"><code>theoretical-background.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides the theoretical foundation for the
<code>CorOncoEndpoints</code> package, covering:</p>
<ul>
<li>The Fleischer model for OS and PFS</li>
<li>Copula-based modeling of dependence</li>
<li>Correlation bounds (Fréchet-Hoeffding)</li>
<li>Mathematical derivations</li>
</ul>
</div>
<div class="section level2">
<h2 id="the-fleischer-model">The Fleischer Model<a class="anchor" aria-label="anchor" href="#the-fleischer-model"></a>
</h2>
<div class="section level3">
<h3 id="model-specification">Model Specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h3>
<p>The Fleischer model (2009) provides a framework for modeling the
dependence between overall survival (OS) and progression-free survival
(PFS).</p>
<p><strong>Key Components:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Overall Survival (OS)</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>S</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">OS \sim \text{Exp}(\lambda_{OS})</annotation></semantics></math>
</li>
<li>
<strong>Time to Progression (TTP)</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>P</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">TTP \sim \text{Exp}(\lambda_{TTP})</annotation></semantics></math>
</li>
<li>
<strong>Progression-Free Survival (PFS)</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS = \min(OS, TTP)</annotation></semantics></math>
</li>
</ol>
<p>where OS and TTP are independent.</p>
</div>
<div class="section level3">
<h3 id="important-properties">Important Properties<a class="anchor" aria-label="anchor" href="#important-properties"></a>
</h3>
<p><strong>Property 1</strong>: PFS follows an exponential distribution
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS \sim \text{Exp}(\lambda_{PFS})</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{PFS} = \lambda_{OS} + \lambda_{TTP}</annotation></semantics></math></p>
<p><strong>Proof</strong>: Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS = \min(OS, TTP)</annotation></semantics></math>
with independent exponentials,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mi>t</mi></mrow></msup><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mi>t</mi></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P(PFS &gt; t) = P(OS &gt; t) \cdot P(TTP &gt; t) = e^{-\lambda_{OS}t} \cdot e^{-\lambda_{TTP}t} = e^{-(\lambda_{OS} + \lambda_{TTP})t}</annotation></semantics></math></p>
<p><strong>Property 2</strong>: Correlation between OS and PFS
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><msub><mi>λ</mi><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msub></mfrac><mo>=</mo><mfrac><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mrow><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Corr}(OS, PFS) = \frac{\lambda_{OS}}{\lambda_{PFS}} = \frac{\lambda_{OS}}{\lambda_{OS} + \lambda_{TTP}}</annotation></semantics></math></p>
<p>This ensures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \text{Corr}(OS, PFS) &lt; 1</annotation></semantics></math>
and automatically satisfies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>≤</mo><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">PFS \leq OS</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="median-survival-times">Median Survival Times<a class="anchor" aria-label="anchor" href="#median-survival-times"></a>
</h3>
<p>For exponentially distributed time-to-event variables:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Median</mtext><mo>=</mo><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>λ</mi></mfrac></mrow><annotation encoding="application/x-tex">\text{Median} = \frac{\log(2)}{\lambda}</annotation></semantics></math></p>
<p>Therefore: - Median OS =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub></mfrac><annotation encoding="application/x-tex">\frac{\log(2)}{\lambda_{OS}}</annotation></semantics></math>
- Median PFS =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>λ</mi><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msub></mfrac><annotation encoding="application/x-tex">\frac{\log(2)}{\lambda_{PFS}}</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="copula-based-dependence-modeling">Copula-Based Dependence Modeling<a class="anchor" aria-label="anchor" href="#copula-based-dependence-modeling"></a>
</h2>
<div class="section level3">
<h3 id="what-is-a-copula">What is a Copula?<a class="anchor" aria-label="anchor" href="#what-is-a-copula"></a>
</h3>
<p>A copula is a function that links marginal distributions to their
joint distribution. For two random variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
with marginal distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>X</mi></msub><annotation encoding="application/x-tex">F_X</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">F_Y</annotation></semantics></math>,
the copula
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
satisfies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>X</mi><mo>,</mo><mi>Y</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>F</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_{X,Y}(x,y) = C(F_X(x), F_Y(y))</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="why-copulas">Why Copulas?<a class="anchor" aria-label="anchor" href="#why-copulas"></a>
</h3>
<p>Copulas allow us to:</p>
<ol style="list-style-type: decimal">
<li>Separate marginal behavior from dependence structure</li>
<li>Model non-linear dependencies</li>
<li>Handle different types of tail dependence</li>
</ol>
</div>
<div class="section level3">
<h3 id="clayton-copula">Clayton Copula<a class="anchor" aria-label="anchor" href="#clayton-copula"></a>
</h3>
<p><strong>Definition</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>u</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>+</mo><msup><mi>v</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>θ</mi></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mi>θ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">C(u, v; \theta) = (u^{-\theta} + v^{-\theta} - 1)^{-1/\theta}, \quad \theta &gt; 0</annotation></semantics></math></p>
<p><strong>Properties</strong>:</p>
<ul>
<li>Lower tail dependence:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>L</mi></msub><mo>=</mo><msup><mn>2</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>θ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\lambda_L = 2^{-1/\theta}</annotation></semantics></math>
</li>
<li>Upper tail independence:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>U</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_U = 0</annotation></semantics></math>
</li>
<li>Kendall’s tau:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mi>θ</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau = \theta / (\theta + 2)</annotation></semantics></math>
</li>
<li>
<strong>Cannot model negative dependence</strong> (requires
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta &gt; 0</annotation></semantics></math>)</li>
</ul>
<p><strong>Conditional Distribution</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mn>2</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>u</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>∂</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>u</mi></mrow></mfrac><mo>=</mo><msup><mi>u</mi><mrow><mo>−</mo><mi>θ</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>u</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>+</mo><msup><mi>v</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>θ</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">C_{2|1}(v|u; \theta) = \frac{\partial C(u,v;\theta)}{\partial u} = u^{-\theta-1}(u^{-\theta} + v^{-\theta} - 1)^{-1/\theta - 1}</annotation></semantics></math></p>
<p>This is used in the generation algorithm.</p>
</div>
<div class="section level3">
<h3 id="frank-copula">Frank Copula<a class="anchor" aria-label="anchor" href="#frank-copula"></a>
</h3>
<p><strong>Definition</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>θ</mi></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi><mi>u</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi><mi>v</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C(u, v; \theta) = -\frac{1}{\theta} \log\left(1 + \frac{(e^{-\theta u} - 1)(e^{-\theta v} - 1)}{e^{-\theta} - 1}\right)</annotation></semantics></math></p>
<p><strong>Properties</strong>:</p>
<ul>
<li>Symmetric: No tail dependence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>L</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>U</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_L = \lambda_U = 0</annotation></semantics></math>)</li>
<li>Kendall’s tau:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mn>4</mn><mi>θ</mi></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msub><mi>D</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\tau = 1 - \frac{4}{\theta}\left[1 - D_1(\theta)\right]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mn>1</mn></msub><annotation encoding="application/x-tex">D_1</annotation></semantics></math>
is the Debye function</li>
<li>
<strong>Can model negative dependence</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
can be negative)</li>
</ul>
<p><strong>Conditional Distribution</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mn>2</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>u</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi><mi>v</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi><mi>v</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi><mi>u</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>θ</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">C_{2|1}(v|u; \theta) = \frac{(e^{-\theta v} - 1)(e^{-\theta} - 1)}{(e^{-\theta v} - 1) + (e^{-\theta u} - 1)(e^{-\theta} - 1)}</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="correlation-bounds">Correlation Bounds<a class="anchor" aria-label="anchor" href="#correlation-bounds"></a>
</h2>
<div class="section level3">
<h3 id="fréchet-hoeffding-bounds">Fréchet-Hoeffding Bounds<a class="anchor" aria-label="anchor" href="#fr%C3%A9chet-hoeffding-bounds"></a>
</h3>
<p>For any copula
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>+</mo><mi>v</mi><mo>−</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max(u + v - 1, 0) \leq C(u,v) \leq \min(u, v)</annotation></semantics></math></p>
<p>These bounds correspond to:</p>
<ul>
<li>
<strong>Lower bound</strong>: Perfect negative dependence
(countermonotonic copula)</li>
<li>
<strong>Upper bound</strong>: Perfect positive dependence
(comonotonic copula)</li>
</ul>
</div>
<div class="section level3">
<h3 id="correlation-bounds-for-tte-and-binary-response">Correlation Bounds for TTE and Binary Response<a class="anchor" aria-label="anchor" href="#correlation-bounds-for-tte-and-binary-response"></a>
</h3>
<p>For a time-to-event variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T \sim \text{Exp}(\lambda)</annotation></semantics></math>
and binary response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R \sim \text{Bernoulli}(p)</annotation></semantics></math>:</p>
<p><strong>Lower Bound</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>=</mo><mo>−</mo><msqrt><mfrac><mi>p</mi><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></msqrt><msubsup><mo>∫</mo><mn>0</mn><msub><mi>q</mi><mi>p</mi></msub></msubsup><msup><mi>e</mi><mrow><mo>−</mo><mi>λ</mi><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\rho_{lower} = -\sqrt{\frac{p}{1-p}} \int_0^{q_p} e^{-\lambda t} dt</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>p</mi></msub><annotation encoding="application/x-tex">q_p</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-th
quantile of the exponential distribution.</p>
<p><strong>Upper Bound</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>u</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>=</mo><msqrt><mfrac><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow><mi>p</mi></mfrac></msqrt><msubsup><mo>∫</mo><msub><mi>q</mi><mi>p</mi></msub><mi>∞</mi></msubsup><msup><mi>e</mi><mrow><mo>−</mo><mi>λ</mi><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\rho_{upper} = \sqrt{\frac{1-p}{p}} \int_{q_p}^\infty e^{-\lambda t} dt</annotation></semantics></math></p>
<p>These simplify to:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>=</mo><mo>−</mo><msqrt><mfrac><mi>p</mi><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{lower} = -\sqrt{\frac{p}{1-p}}(1 - p)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>u</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>=</mo><msqrt><mfrac><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow><mi>p</mi></mfrac></msqrt><mo>⋅</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\rho_{upper} = \sqrt{\frac{1-p}{p}} \cdot p</annotation></semantics></math></p>
<p><strong>Important</strong>: These bounds depend only on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
not on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
(for the TTE-Response case).</p>
</div>
<div class="section level3">
<h3 id="correlation-bounds-for-pfs-and-response">Correlation Bounds for PFS and Response<a class="anchor" aria-label="anchor" href="#correlation-bounds-for-pfs-and-response"></a>
</h3>
<p>In the three-endpoint framework (OS + PFS + Response), the bounds for
PFS-Response correlation are more complex and depend on both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
and the hazard rates:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ρ</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msubsup><mo>=</mo><msqrt><mfrac><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow><mi>p</mi></mfrac></msqrt><mfrac><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mi>/</mi><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{lower}^{PFS} = \sqrt{\frac{1-p}{p}} \frac{\lambda_{OS}}{\lambda_{TTP}} \left[(1-p)^{\lambda_{TTP}/\lambda_{OS}} - 1\right]</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ρ</mi><mrow><mi>u</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msubsup><mo>=</mo><msqrt><mfrac><mi>p</mi><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></msqrt><mfrac><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mi>p</mi><mrow><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mi>/</mi><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{upper}^{PFS} = \sqrt{\frac{p}{1-p}} \frac{\lambda_{OS}}{\lambda_{TTP}} \left[1 - p^{\lambda_{TTP}/\lambda_{OS}}\right]</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mrow><mi>P</mi><mi>F</mi><mi>S</mi></mrow></msub><mo>−</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{TTP} = \lambda_{PFS} - \lambda_{OS}</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-generation-algorithm">Data Generation Algorithm<a class="anchor" aria-label="anchor" href="#data-generation-algorithm"></a>
</h2>
<div class="section level3">
<h3 id="step-1-generate-uniform-random-variables">Step 1: Generate Uniform Random Variables<a class="anchor" aria-label="anchor" href="#step-1-generate-uniform-random-variables"></a>
</h3>
<p>For copula-based generation:</p>
<ol style="list-style-type: decimal">
<li>Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>∼</mo><mtext mathvariant="normal">Uniform</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_1 \sim \text{Uniform}(0,1)</annotation></semantics></math>
</li>
<li>Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>2</mn></msub><mo>∼</mo><mtext mathvariant="normal">Uniform</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_2 \sim \text{Uniform}(0,1)</annotation></semantics></math>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="step-2-apply-copula-transform">Step 2: Apply Copula Transform<a class="anchor" aria-label="anchor" href="#step-2-apply-copula-transform"></a>
</h3>
<p>Use the conditional copula to transform
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mn>2</mn></msub><annotation encoding="application/x-tex">U_2</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><msub><mi>C</mi><mrow><mn>2</mn><mo stretchy="false" form="prefix">|</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>U</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>U</mi><mn>1</mn></msub><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V = C_{2|1}(U_2|U_1; \theta)</annotation></semantics></math></p>
<p>Now
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>U</mi><mn>1</mn></msub><mo>,</mo><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(U_1, V)</annotation></semantics></math>
have the desired dependence structure.</p>
</div>
<div class="section level3">
<h3 id="step-3-apply-inverse-cdf-transform">Step 3: Apply Inverse CDF Transform<a class="anchor" aria-label="anchor" href="#step-3-apply-inverse-cdf-transform"></a>
</h3>
<p>Transform uniforms to target distributions:</p>
<ul>
<li>
<strong>For TTE</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>λ</mi></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>U</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T = -\frac{1}{\lambda}\log(1 - U_1)</annotation></semantics></math>
</li>
<li>
<strong>For Response</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>𝟙</mn><mo stretchy="false" form="prefix">{</mo><mi>V</mi><mo>&gt;</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">R = \mathbb{1}\{V &gt; 1 - p\}</annotation></semantics></math>
</li>
</ul>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>𝟙</mn><mo stretchy="false" form="prefix">{</mo><mo>⋅</mo><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbb{1}\{\cdot\}</annotation></semantics></math>
is the indicator function.</p>
</div>
<div class="section level3">
<h3 id="step-4-enforce-pfs-os-constraint">Step 4: Enforce PFS ≤ OS Constraint<a class="anchor" aria-label="anchor" href="#step-4-enforce-pfs-os-constraint"></a>
</h3>
<p>When generating all three endpoints:</p>
<ol style="list-style-type: decimal">
<li>Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>S</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>O</mi><mi>S</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">OS \sim \text{Exp}(\lambda_{OS})</annotation></semantics></math>
</li>
<li>Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>P</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>T</mi><mi>T</mi><mi>P</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">TTP \sim \text{Exp}(\lambda_{TTP})</annotation></semantics></math>
independently</li>
<li>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS = \min(OS, TTP)</annotation></semantics></math>
</li>
</ol>
<p>This automatically ensures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>≤</mo><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">PFS \leq OS</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-copula-parameters">Calculating Copula Parameters<a class="anchor" aria-label="anchor" href="#calculating-copula-parameters"></a>
</h2>
<div class="section level3">
<h3 id="from-correlation-to-theta">From Correlation to Theta<a class="anchor" aria-label="anchor" href="#from-correlation-to-theta"></a>
</h3>
<p>Given desired correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
between TTE and Response, we need to find copula parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p><strong>For Clayton Copula</strong>:</p>
<p>Solve numerically:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>,</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mrow><mi>C</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>t</mi><mi>o</mi><mi>n</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho = \text{Corr}(T, R) = f_{Clayton}(\theta, p, \lambda)</annotation></semantics></math></p>
<p>using Hoeffding’s formula for covariance.</p>
<p><strong>For Frank Copula</strong>:</p>
<p>Solve numerically:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>,</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mrow><mi>F</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho = \text{Corr}(T, R) = f_{Frank}(\theta, p, \lambda)</annotation></semantics></math></p>
<p>The package implements these using numerical optimization (bisection
method).</p>
</div>
</div>
<div class="section level2">
<h2 id="validation-metrics">Validation Metrics<a class="anchor" aria-label="anchor" href="#validation-metrics"></a>
</h2>
<div class="section level3">
<h3 id="bias">Bias<a class="anchor" aria-label="anchor" href="#bias"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bias</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">\text{Bias}(\hat{\theta}) = E[\hat{\theta}] - \theta</annotation></semantics></math></p>
<p>Measures systematic error. Should be close to 0 for unbiased
estimators.</p>
</div>
<div class="section level3">
<h3 id="mean-squared-error-mse">Mean Squared Error (MSE)<a class="anchor" aria-label="anchor" href="#mean-squared-error-mse"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">MSE</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mtext mathvariant="normal">Bias</mtext><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{MSE}(\hat{\theta}) = E[(\hat{\theta} - \theta)^2] = \text{Var}(\hat{\theta}) + \text{Bias}^2(\hat{\theta})</annotation></semantics></math></p>
<p>Combines variance and bias into a single measure.</p>
</div>
<div class="section level3">
<h3 id="root-mean-squared-error-rmse">Root Mean Squared Error (RMSE)<a class="anchor" aria-label="anchor" href="#root-mean-squared-error-rmse"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">RMSE</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mtext mathvariant="normal">MSE</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">\text{RMSE}(\hat{\theta}) = \sqrt{\text{MSE}(\hat{\theta})}</annotation></semantics></math></p>
<p>Error measure in the original scale.</p>
</div>
<div class="section level3">
<h3 id="relative-bias">Relative Bias<a class="anchor" aria-label="anchor" href="#relative-bias"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Relative Bias</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mtext mathvariant="normal">Bias</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>θ</mi></mfrac><mo>×</mo><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\text{Relative Bias}(\hat{\theta}) = \frac{\text{Bias}(\hat{\theta})}{\theta} \times 100\%</annotation></semantics></math></p>
<p>Expresses bias as a percentage of the true value.</p>
</div>
</div>
<div class="section level2">
<h2 id="mathematical-derivations">Mathematical Derivations<a class="anchor" aria-label="anchor" href="#mathematical-derivations"></a>
</h2>
<div class="section level3">
<h3 id="derivation-of-corros-pfs">Derivation of Corr(OS, PFS)<a class="anchor" aria-label="anchor" href="#derivation-of-corros-pfs"></a>
</h3>
<p>Given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS = \min(OS, TTP)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>S</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">OS \sim \text{Exp}(\lambda_1)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>P</mi><mo>∼</mo><mtext mathvariant="normal">Exp</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">TTP \sim \text{Exp}(\lambda_2)</annotation></semantics></math>
independent:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>⋅</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>O</mi><mi>S</mi><mo stretchy="false" form="prefix">|</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>O</mi><mi>S</mi><mo stretchy="false" form="prefix">|</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>&lt;</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>&lt;</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E[PFS \cdot OS] = E[PFS] \cdot E[OS|PFS = OS] \cdot P(PFS = OS) + E[PFS] \cdot E[OS|PFS &lt; OS] \cdot P(PFS &lt; OS)</annotation></semantics></math></p>
<p>After integration:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\text{Cov}(OS, PFS) = \frac{1}{(\lambda_1 + \lambda_2)^2}</annotation></semantics></math></p>
<p>And since:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\text{Var}(OS) = \frac{1}{\lambda_1^2}, \quad \text{Var}(PFS) = \frac{1}{(\lambda_1 + \lambda_2)^2}</annotation></semantics></math></p>
<p>We get:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mtext mathvariant="normal">Cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac><mo>=</mo><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Corr}(OS, PFS) = \frac{\text{Cov}(OS, PFS)}{\sqrt{\text{Var}(OS) \cdot \text{Var}(PFS)}} = \frac{\lambda_1}{\lambda_1 + \lambda_2}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="derivation-of-pfs-response-correlation">Derivation of PFS-Response Correlation<a class="anchor" aria-label="anchor" href="#derivation-of-pfs-response-correlation"></a>
</h3>
<p>In the three-endpoint framework, the correlation between PFS and
Response is derived from:</p>
<ol style="list-style-type: decimal">
<li>The specified correlation between OS and Response</li>
<li>The Fleischer model relationship
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>F</mi><mi>S</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>S</mi><mo>,</mo><mi>T</mi><mi>T</mi><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PFS = \min(OS, TTP)</annotation></semantics></math>
</li>
<li>The copula linking OS and Response</li>
</ol>
<p>The derivation involves:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>,</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo>⋅</mo><mi>R</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mi>F</mi><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>R</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Cov}(PFS, R) = E[PFS \cdot R] - E[PFS] \cdot E[R]</annotation></semantics></math></p>
<p>This requires computing integrals over the copula-linked
distributions, which is done numerically in the package.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Fleischer, F., Gaschler-Markefski, B., &amp; Bluhmki, E.
(2009)</strong>. A statistical model for the dependence between
progression-free survival and overall survival. <em>Statistics in
Medicine</em>, 28(21), 2669-2686.</p></li>
<li><p><strong>Trivedi, P. K., &amp; Zimmer, D. M. (2005)</strong>.
Copula modeling: an introduction for practitioners. <em>Foundations and
Trends in Econometrics</em>, 1(1), 1-111.</p></li>
<li><p><strong>Nelsen, R. B. (2006)</strong>. <em>An introduction to
copulas</em> (2nd ed.). Springer.</p></li>
<li><p><strong>Hofert, M., Kojadinovic, I., Maechler, M., &amp; Yan, J.
(2018)</strong>. <em>Elements of copula modeling with R</em>.
Springer.</p></li>
<li><p><strong>Joe, H. (2014)</strong>. <em>Dependence modeling with
copulas</em>. CRC Press.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette provided the mathematical foundation for:</p>
<ul>
<li>The Fleischer model for OS and PFS</li>
<li>Copula-based dependence modeling (Clayton and Frank)</li>
<li>Correlation bounds based on Fréchet-Hoeffding bounds</li>
<li>Data generation algorithms</li>
<li>Validation metrics</li>
</ul>
<p>Understanding these concepts helps users: - Choose appropriate
parameter values - Interpret simulation results - Validate model
assumptions - Extend the methodology</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gosuke Homma</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

    </footer>
</div>





  </body>
</html>
